<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jonny Paes - Github</title>
  <style>
  :root {
    --wm-sb-bg-color: #333;
    --dm-sb-bg-color: black;
    --wm-sb-item-color: black;
    --dm-sb-item-color: white;
    --wm-ct-bg-color: #f4f4f4;
    --dm-ct-bg-color: #303030;
    --wm-ct-text-color: black;
    --dm-ct-text-color: white;
  }
  body {
    margin: 0;
    font-family: Arial, sans-serif;
  }
  .flex-item {
    border: 1px solid rgba(0, 0, 0, 0.1);
    background: rgba(255, 255, 255, 0.8);
    padding: 15px;
    margin: 5px 0;
    border-radius: 4px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
  }
  .sidebar .flex-item {
    background: rgba(255, 255, 255, 0.1);
    border: none;
    color: #eee;
  }
  .sidebar,
  .content {
    display: flex;
    flex-direction: column;
    gap: 10px;
    padding: 10px;
    overflow-y: auto;
  }
  .sidebar a {
    color: #81c784;
  }
  .container {
    display: flex;
    width: 100vw;
    height: 100vh;
  }
  .sidebar {
    flex: 0.382;
    background: #333;
    color: white;
  }
  .content {
    flex: 0.618;
    background: #f4f4f4;
  }
  @media (prefers-color-scheme: dark) {
    .sidebar {
      color: var(--dm-sb-item-color);
      background-color: var(--dm-sb-bg-color);
    }
    .content {
      color: var(--dm-ct-item-color);
      background-color: var(--dm-ct-bg-color);
    }
  }
    
  /* In portrait mode (height > width), invert layout: sidebar on top */
  @media (orientation: portrait) {
    .container {
      flex-direction: column;
    }
    .sidebar,
    .content {
      width: 100%;
      height: auto;
    }
  }
  a {
    color: inherit;
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
  </style>
</head>

<body>

<script>
function makeAbsoluteUrl(url) {
    if (!url) return '';
    if (url.startsWith('http://') || url.startsWith('https://')) return url;
    return 'https://' + url;
}

function createElement(type, id, className, textContent = '') {
    const el = document.createElement(type);
    if (id) el.id = id;
    if (className) el.classList.add(className);
    if (textContent) el.textContent = textContent;
    return el;
}

function applyGoldenRatio(baseSize, depth) {
    return baseSize / Math.pow(1.618, depth);
}

function buildSidebar(parent, userData) {
    const fields = [
      { label: 'Name', key: 'name' },
      { label: 'GitHub URL', key: 'html_url' },
      { label: 'Blog', key: 'blog' },
      { label: 'Location', key: 'location' }
    ];
    
    fields.forEach(field => {
      const item = createElement('div', '', 'flex-item');
      item.style.fontSize = applyGoldenRatio(18, 1) + 'px';
      const rawValue = userData[field.key] || 'N/A';
      
      if ((field.key === 'html_url' || field.key === 'blog') && rawValue !== 'N/A') {
            const hrefUrl = field.key === 'blog' ? makeAbsoluteUrl(rawValue) : rawValue;
            item.innerHTML = `${field.label}: <br><a href="${hrefUrl}" target="_blank">${rawValue}</a>`;
      } else {
        item.textContent = field.label + ': ' + rawValue;
      }
      parent.appendChild(item);
    });
}

function buildContent(parent, reposData) {
    const ignoredRepoName = window.location.hostname;
    reposData.forEach(repo => {
        if (repo.name === ignoredRepoName) return;
        
        const repoContainer = createElement('div', '', 'flex-item');
        repoContainer.style.fontSize = applyGoldenRatio(20, 1) + 'px';
        
        repoContainer.innerHTML = `
            <div style="margin-bottom:5px;"><strong>${repo.name}</strong></div>
            <div style="font-size: 0.9em; margin-bottom:5px;"><a href="${repo.html_url}" target="_blank">View Code</a> | <a href="${repo.homepage || '#'}" target="_blank">Homepage</a></div>
            <div style="font-style: italic; margin-bottom:5px;">${repo.description || 'No description.'}</div>
            <div style="font-size: 0.8em; opacity: 0.8;">${repo.language || 'N/A'}</div>
        `;
        parent.appendChild(repoContainer);
    });
}

async function init() {
    const userUrl = 'https://api.github.com/users/jonnypaes';
    const reposUrl = 'https://api.github.com/users/jonnypaes/repos';
    try {
        const [userData, reposData] = await Promise.all([
            fetchData(userUrl),
            fetchData(reposUrl)
        ]);
        const container = createElement('div', '', 'container');
        const sidebar = createElement('div', 'sidebar', 'sidebar');
        const content = createElement('div', 'content', 'content');
        
        buildSidebar(sidebar, userData);
        buildContent(content, reposData);
        
        container.appendChild(sidebar);
        container.appendChild(content);
        document.body.appendChild(container);
        
    } catch (error) {
        console.error("Error fetching data:", error);
    }
}

async function fetchData(url) {
    const response = await fetch(url);
    return response.json();
}

init();
</script>

</body>
</html>
